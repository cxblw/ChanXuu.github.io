(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{501:function(a,t,e){"use strict";e.r(t);var s=e(4),n=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"目标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目标"}},[a._v("#")]),a._v(" 目标")]),a._v(" "),e("p",[a._v("本地push代码到GitHub/Gitee 上时,Webhook自动触发,将GitHub/Gitee上的代码通过jenkins的构建,实现 "),e("code",[a._v("打包代码-部署到服务器")]),a._v(" 这一过程")]),a._v(" "),e("h2",{attrs:{id:"准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[a._v("#")]),a._v(" 准备工作")]),a._v(" "),e("ol",[e("li",[a._v("GitHub/Gitee 的账号")]),a._v(" "),e("li",[a._v("服务器一台")]),a._v(" "),e("li",[a._v("服务器安装JAVA环境")]),a._v(" "),e("li",[a._v("服务器安装Nginx并启动")]),a._v(" "),e("li",[a._v("服务器安装Jenkins并启动")])]),a._v(" "),e("h2",{attrs:{id:"步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[a._v("#")]),a._v(" 步骤")]),a._v(" "),e("h3",{attrs:{id:"_1-登录服务器更新系统软件-可有可无"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录服务器更新系统软件-可有可无"}},[a._v("#")]),a._v(" 1. 登录服务器更新系统软件(可有可无)")]),a._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[a._v(" yum update\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-安装java和git"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装java和git"}},[a._v("#")]),a._v(" 2. 安装Java和git")]),a._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[a._v(" yum install java\n yum install git\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("h3",{attrs:{id:"_3-安装nginx并启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装nginx并启动"}},[a._v("#")]),a._v(" 3. 安装nginx并启动")]),a._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[a._v(" yum install nginx "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//安装")]),a._v("\n service nginx start "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//启动")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",[a._v("出现 "),e("code",[a._v("Redirecting to /bin/systemctl start nginx.service")]),a._v(" 表示开启成功,\n访问"),e("a",{attrs:{href:""}},[a._v("http://你的ip/")]),a._v(",成功会出现nginx默认页面")])]),a._v(" "),e("h3",{attrs:{id:"_4-安装jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装jenkins"}},[a._v("#")]),a._v(" 4. 安装Jenkins")]),a._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[a._v(" wget "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("O")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("etc"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("yum"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("repos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("d"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("jenkins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("repo http"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("pkg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("jenkins"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ci"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("redhat"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("jenkins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("repo\n\nrpm "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" https"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("jenkins"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ci"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("redhat"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("jenkins"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("ci"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("org"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("key \n\n yum install jenkins "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//完成之后直接使用 yum 命令安装 Jenkins")]),a._v("\n\n service jenkins restart  "),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//启动 jenkins")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br")])]),e("ul",[e("li",[a._v("jenkins启动成功后默认的是8080端口，输入你的服务器 ip 地址加8080 端口就可以访问了。")]),a._v(" "),e("li",[a._v("在终端输入 "),e("code",[a._v("cat /var/lib/jenkins/secrets/initialAdminPassword")]),a._v(" 可以获得jenkins的管理员密码")]),a._v(" "),e("li",[a._v("推荐通用插件安装,接下来等待它安装即可")])]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",[a._v("如果 "),e("code",[a._v("yum install jenkins")]),a._v(" 后出现 "),e("code",[a._v("warning: rpmts_HdrFromFdno: Header V4 DSA/SHA1 Signature, key ID d50582e6: NOKEY")]),a._v(" 类似的错误,可以尝试 "),e("code",[a._v("yum install --nogpgcheck jenkins")]),a._v(" 掉gpg检查")])]),a._v(" "),e("h3",{attrs:{id:"_5-安装jenkins插件方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-安装jenkins插件方法"}},[a._v("#")]),a._v(" 5. 安装Jenkins插件方法")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB9251bcec6b3ccea7b82462a18e98e97b?method=download&shareKey=975b39f7d4577dfd58e8f7e4524d7b2b",alt:"alt 安装插件"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBd45ec6579578ed02c909a18f31d1a496?method=download&shareKey=ecda40c4d9f4fa04d60474e0077d9bcb",alt:"alt 安装插件"}})]),a._v(" "),e("h3",{attrs:{id:"_6-安装nodejs插件-并配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-安装nodejs插件-并配置"}},[a._v("#")]),a._v(" 6. 安装nodejs插件,并配置")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB4531d7610537a22b335aa356a2f8bdde?method=download&shareKey=7a6e759457805fb085302c71cfb1faa5",alt:"alt 安装nodejs"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB165211e18304584dbf9f645aab0ef9f9?method=download&shareKey=e391a0097260cee997d8e3d27bc5c145",alt:"alt 安装nodejs"}})]),a._v(" "),e("h3",{attrs:{id:"_7-创建任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-创建任务"}},[a._v("#")]),a._v(" 7. 创建任务")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB64e3855f57fb3785fa7e1c86644ce5d1?method=download&shareKey=0846393cd6cc35bf9916a54bbd85eb1d",alt:"alt 创建任务"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBe8e73271aa2cec2b25434a470b0b2637?method=download&shareKey=025a0e512277cbb1df0413d349ec87bb",alt:"alt 创建任务"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBb7e9a31b7f409a15e1a83cc12715c0c6?method=download&shareKey=b80842f9f2fdade96a1979eeffe2f31d",alt:"alt 创建任务"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBcd7368347b5d97a1ed9a8f39b0d74a46?method=download&shareKey=5eadedf060256805616c02a5adaef354",alt:"alt 创建任务"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB8047d38725501a155c836e1d93ba795a?method=download&shareKey=aa38b6106f5648d528ebb17a9d0ee60d",alt:"alt 创建任务"}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBe554bc40038afbaabd7f0428e9505692?method=download&shareKey=f3f7d961679a1a2bfe25ec5604b2cd4d",alt:"alt 创建任务"}})]),a._v(" "),e("p",[a._v("到了这一步,我们已经完成了Jenkins将代码push并打包的过程")]),a._v(" "),e("h3",{attrs:{id:"_8-安装publish-over-ssh-插件，实现服务器部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-安装publish-over-ssh-插件，实现服务器部署"}},[a._v("#")]),a._v(" 8. 安装Publish Over SSH 插件，实现服务器部署")]),a._v(" "),e("ol",[e("li",[a._v("先安装插件,安装完成后,进入 "),e("code",[a._v("Manage Jenkins -> Configure System -> Publish over SSH")]),a._v(" "),e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB386cf9baf99dd6dadeb14f6a547993ac?method=download&shareKey=17623a599d7fdf721391be546becb4ac",alt:"alt 部署"}})])]),a._v(" "),e("p",[a._v("填写完后点击test，出现Success说明配置成功")]),a._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[a._v("在刚才的testJenkins工程中配置 "),e("code",[a._v("构建后操作")]),a._v(" ，选择 "),e("code",[a._v("send build artificial over SSH")])])]),a._v(" "),e("p",[a._v("还要在构建中添加压缩dist目录命令")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBe90cdca31a42c83fc4a5bff8648f99c5?method=download&shareKey=6f3c398befce5929cea0c0487902ae0d",alt:"alt 部署"}})]),a._v(" "),e("p",[a._v("填完后执行构建。成功后可以发现目标服务器发现项目目录下有了要运行的文件,直接访问域名就发现可以访问了")]),a._v(" "),e("p",[a._v("接下来实现开发本地push代码到github上后，触发Webhook，jenkins自动执行构建。")]),a._v(" "),e("h3",{attrs:{id:"_9-触发webhook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-触发webhook"}},[a._v("#")]),a._v(" 9. 触发Webhook")]),a._v(" "),e("p",[a._v("在刚才的testJenkins工程中点击构建触发器中选择 "),e("code",[a._v("Generic Webhook Trigger")]),a._v(" ，填写token\n"),e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEB4b0f914b3b4394c5c5e759f911888539?method=download&shareKey=71daf9e8f8cc7407b35305bdd36a006d",alt:"alt 配置webhook"}})]),a._v(" "),e("ul",[e("li",[e("p",[a._v("github配置Webhook\n选择github项目中的 "),e("code",[a._v("Settings->Webhooks>add webhook")]),a._v(" "),e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBb0d302fb27ee06ab2617137c6477fa93?method=download&shareKey=0969994f222f8c1dbe23544d503d6915",alt:"alt 配置webhook"}})])]),a._v(" "),e("li",[e("p",[a._v("gitee配置Webhook\n"),e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBc98934819db061a07402f5ce2006223c?method=download&shareKey=aa3c0c1978c0a8ded719ab924d8e5bd5",alt:"alt 配置webhook"}})])])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/api/personal/file/WEBc16a3d3ddeef02c0ebae997061960eaa?method=download&shareKey=ca6210f1b44b5ea2d92c298b5ec272ef",alt:"alt 配置webhook"}})]),a._v(" "),e("p",[a._v("最后修改项目内容,使用git提交,jenkins就会自动帮我们push代码,打包,然后部署到服务器了,等jenkins自动构建完成后,再访问项目域名,会发现内容已经改变了")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",[a._v("参考文章"),e("a",{attrs:{href:"https://segmentfault.com/a/1190000019212628",target:"_blank",rel:"noopener noreferrer"}},[a._v(" https://segmentfault.com/a/1190000019212628"),e("OutboundLink")],1),a._v("\n感谢作者的文章,让我跟着步骤学会了前端项目的自动部署")])])])}),[],!1,null,null,null);t.default=n.exports}}]);